<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Config 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.bespinlab.nivea.repository.CelebRepository">

	<select id="search" parameterType="kr.bespinlab.nivea.parameter.CelebPageParam" resultType="kr.bespinlab.nivea.domain.Celeb">
		SELECT
			celeb_id
			, celeb_code
			, stage_name
			, stage_name_en
			, real_name
			, real_name_en
			, gender
			, birth_date
			, debut_year
			, country
			, country_en
			, state
			, city
			, height
			, weight
			, company
			 ,updated
		FROM celebs
		<where>
			<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(searchParam.keyword)">
				AND stage_name LIKE CONCAT('%', #{searchParam.keyword}, '%')
			</if>
		</where>
		ORDER BY stage_name ASC
		LIMIT #{pageRequest.limit}, #{pageRequest.offset}
	</select>

	<select id="count" parameterType="kr.bespinlab.nivea.parameter.CelebSearchParam" resultType="int">
		SELECT
			COUNT(celeb_id) AS count
		FROM celebs
		<where>
			<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(keyword)">
				AND stage_name LIKE CONCAT('%', #{keyword}, '%')
			</if>
		</where>
	</select>
</mapper>